cmake_minimum_required(VERSION 2.6)
project(stack)
list(APPEND CMAKE_CXX_FLAGS "-std=c++0x -O3 -Werror=return-type")
add_executable(build/stack StackCue.cpp StackCueBase.cpp StackCueHelper.cpp StackCueList.cpp StackAudioCue.cpp StackFadeCue.cpp StackApp.cpp StackWindow.cpp main.cpp StackAudioDevice.cpp StackPulseAudioDevice.cpp)
include(FindPkgConfig)
find_package(PkgConfig REQUIRED)
pkg_check_modules(GTK3 REQUIRED gtk+-3.0)
find_package(PulseAudio REQUIRED)
find_package(Threads REQUIRED)
pkg_check_modules(JSONCPP REQUIRED jsoncpp)

## LAME doesn't ship with a CMake file 
find_path(LAME_INCLUDE_DIRS lame/lame.h)
find_library(LAME_LIBRARIES mp3lame)
include(FindPackageHandleStandardArgs)
find_package_handle_standard_args(Lame DEFAULT_MSG LAME_INCLUDE_DIRS LAME_LIBRARIES)
list(APPEND LAME_DEFINITIONS -DHAVE_LIBMP3LAME=1)
mark_as_advanced(LAME_INCLUDE_DIRS LAME_LIBRARIES LAME_DEFINITIONS)

include_directories("${PROJECT_SOURCE_DIR}")
include_directories(${GTK3_INCLUDE_DIRS})
include_directories(${PULSEAUDIO_INCLUDE_DIRS})
include_directories(${JSONCPP_INCLUDE_DIRS})
include_directories(${LAME_INCLUDE_DIRS})
link_directories(${GTK3_LIBRARY_DIRS})
link_directories(${PULSEAUDIO_LIBRARY_DIR})
link_directories(${JSONCPP_LIBRARY_DIRS})
add_definitions(${GTK3_CFLAGS_OTHER})
target_link_libraries(build/stack ${GTK3_LIBRARIES})
target_link_libraries(build/stack ${PULSEAUDIO_LIBRARY})
target_link_libraries(build/stack ${PULSEAUDIO_MAINLOOP_LIBRARY})
target_link_libraries(build/stack ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(build/stack ${JSONCPP_LIBRARIES})
target_link_libraries(build/stack ${LAME_LIBRARIES})
